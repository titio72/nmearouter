package com.aboni.nmea.router.data.metrics.impl;

import com.aboni.nmea.router.NMEARouterModule;
import com.aboni.nmea.router.data.DataManagementException;
import com.aboni.nmea.router.data.Sample;
import com.aboni.nmea.router.data.QueryByDate;
import com.aboni.nmea.router.utils.ConsoleLog;
import com.aboni.nmea.router.utils.ThingsFactory;
import com.aboni.nmea.router.utils.db.DBHelper;
import com.google.inject.Guice;
import com.google.inject.Injector;
import junit.framework.TestCase;
import org.junit.Test;

import java.time.Instant;

public class DBMetricReaderTest extends TestCase {

    private static final String[] TEST_DATA = new String[] {
            "TW_,2022-12-11T09:47:41Z,3.70119318976867,6.06237756152752,7.68432315067958",
            "TW_,2022-12-11T10:17:53Z,5.20676816778126,7.42112378859905,8.93073855906342",
            "TWD,2022-12-11T10:17:53Z,5.9611987131259,27.8925363598443,41.2134175152718",
            "TW_,2022-12-11T10:21:35Z,7.64257036315676,7.64257051491319,7.64257061608414",
            "TWD,2022-12-11T10:21:35Z,30.4899125626393,30.4899125626393,30.4899125626393",
            "TW_,2022-12-11T10:25:17Z,4.71002954806347,7.39311582529763,9.5172978545664",
            "TWD,2022-12-11T10:25:17Z,2.98667622326087,38.5737372394769,54.9118671839451",
            "TW_,2022-12-11T10:26:17Z,7.30947659380896,8.68674933599647,10.3368674305479",
            "TWD,2022-12-11T10:26:17Z,33.3150723405701,39.4866473807363,51.3758969111467",
            "TW_,2022-12-11T10:27:17Z,6.09764122885121,7.42020396943603,8.86130521799397",
            "TWD,2022-12-11T10:27:17Z,24.6399115420807,34.9831433790434,47.4727045408023",
            "TW_,2022-12-11T10:28:17Z,4.33469741116671,6.49975910319581,8.32620706618507",
            "TW_,2022-12-11T10:28:17Z,4.33469741116671,6.49975910319581,8.32620706618507",
            "TWD,2022-12-11T10:28:17Z,17.8514745439803,34.3973455633385,51.75564013401",
            "TW_,2022-12-11T10:44:17Z,6.85211634556098,6.85211634556098,6.85211634556098",
            "TWD,2022-12-11T10:44:17Z,44.3087155270402,44.3087155270402,44.3087155270402",
            "TW_,2022-12-11T10:58:12Z,3.81486715189922,5.59718956980796,7.03924573901394",
            "TWD,2022-12-11T10:58:12Z,12.4575004538576,30.4454422194505,43.4062074914265",
            "TW_,2022-12-11T10:59:12Z,3.79471932649438,5.55935429068984,6.51950230485178",
            "TWD,2022-12-11T10:59:12Z,21.0827370255121,33.4056373247869,61.2157781382012",
            "TW_,2022-12-11T11:06:52Z,6.09281111411831,6.09281111411831,6.09281111411831",
            "TWD,2022-12-11T11:06:52Z,27.4567174533269,27.4567174533269,27.4567174533269",
            "TW_,2022-12-11T11:14:25Z,3.51814995865304,5.89479284680819,8.44758538625496",
            "TWD,2022-12-11T11:14:25Z,2.22959653463749,47.2810635814228,96.0703369206262",
            "TW_,2022-12-11T11:50:59Z,1.07933469587639,4.08684596123779,8.49252116614007",
            "TWD,2022-12-11T11:50:59Z,12.0358739234703,48.8472448928439,211.75314110812",
            "TW_,2022-12-11T11:51:59Z,2.62689736150719,3.3462628407376,4.71228895996559",
            "TWD,2022-12-11T11:51:59Z,25.2197497258603,53.2684001476328,89.3621220865268",
            "TW_,2022-12-11T11:52:59Z,2.60557373944894,3.50421178737603,5.16323760132304",
            "TWD,2022-12-11T11:52:59Z,35.9163454203688,67.8178493095987,117.94722409507",
            "TW_,2022-12-11T11:53:59Z,2.81733831807716,4.3384008187545,6.3876003112298",
            "TWD,2022-12-11T11:53:59Z,52.6819065734513,79.4371809793892,110.324962519992",
            "TW_,2022-12-11T11:54:59Z,3.12705724062381,3.93832533632019,5.0898896021206",
            "TWD,2022-12-11T11:54:59Z,53.0294018582795,80.8271808696514,135.62024808233",
            "TW_,2022-12-11T11:55:59Z,3.94919250778415,4.69666799282818,5.67937320645835",
            "TWD,2022-12-11T11:55:59Z,57.1694313004155,81.6231434673778,120.963729223699",
            "TW_,2022-12-11T11:56:59Z,3.25016840254273,4.03178071703653,4.86251348700495",
            "TWD,2022-12-11T11:56:59Z,42.7333905745269,79.8360102665385,111.506381081528",
            "TW_,2022-12-11T11:57:59Z,2.15882869899047,3.49429674950279,4.84652938752994",
            "TWD,2022-12-11T11:57:59Z,38.3111211813066,82.1558179385154,137.482367904358",
            "TW_,2022-12-11T11:58:59Z,2.35355803714174,3.18085691854759,3.92884449061067",
            "TWD,2022-12-11T11:58:59Z,39.9153048422411,83.7043829673908,139.241110116873",
            "TW_,2022-12-11T11:59:59Z,2.22000857002799,3.70269008096731,4.39319453830513",
            "TWD,2022-12-11T11:59:59Z,66.2659190666057,85.5870010732038,118.849062444174",
            "TW_,2022-12-11T12:00:59Z,3.2489676884517,3.70668730832754,4.2191009491153",
            "TWD,2022-12-11T12:00:59Z,51.0831169837419,77.254412570284,101.64917202722",
            "TW_,2022-12-11T12:01:59Z,2.63722171963445,3.05317552695212,3.71289172924346",
            "TWD,2022-12-11T12:01:59Z,47.7123449326994,81.8029926831437,116.718504169076",
            "TW_,2022-12-11T12:02:59Z,2.13957491202702,2.74893266961421,3.69421705997238",
            "TWD,2022-12-11T12:02:59Z,49.2845183730037,75.1911183895287,126.842604394884",
            "TW_,2022-12-11T12:03:59Z,2.40467228985744,3.39877014958091,4.54158883567792",
            "TWD,2022-12-11T12:03:59Z,31.1359060708165,66.4339094810019,128.977082824595",
            "TW_,2022-12-11T12:04:59Z,2.84786262084853,3.74545555571273,4.96613565002243",
            "TWD,2022-12-11T12:04:59Z,36.9904090089748,67.9054528974213,101.588038418612",
            "TW_,2022-12-11T12:05:59Z,3.80982997299725,4.59022109962488,5.45438478233009",
            "TWD,2022-12-11T12:05:59Z,59.492514035111,81.8039552535214,104.984488458947",
            "TW_,2022-12-11T12:06:59Z,2.86043160576135,3.9172127448364,4.90490592918064",
            "TWD,2022-12-11T12:06:59Z,35.983250968307,79.3391087037407,130.017946076566",
            "TW_,2022-12-11T12:07:59Z,2.30996363162838,3.42011502853493,4.49274201280325",
            "TWD,2022-12-11T12:07:59Z,47.2964857444175,78.8105708690701,131.701784548881",
            "TW_,2022-12-11T12:08:59Z,2.50298793929389,3.17817070868738,4.39865803228938",
            "TWD,2022-12-11T12:08:59Z,47.1324319483688,92.9243837052285,138.245598096131",
            "TW_,2022-12-11T12:09:59Z,3.5413212492309,4.38058150977995,5.45924157380117",
            "TWD,2022-12-11T12:09:59Z,75.5022314704233,100.514731824555,138.125626412299",
            "TW_,2022-12-11T12:10:59Z,2.17941471073913,3.23369956522847,4.36310162764925",
            "TWD,2022-12-11T12:10:59Z,67.9175988103694,112.471576034159,165.116811276468",
            "TW_,2022-12-11T12:11:59Z,2.6075104250143,3.94029869037762,6.0473712306709",
            "TWD,2022-12-11T12:11:59Z,72.5130584705508,113.247045431543,132.634799611773",
            "TW_,2022-12-11T12:12:59Z,2.0459707241174,3.4153766034924,5.18985353323885",
            "TWD,2022-12-11T12:12:59Z,63.5528186728885,105.775756152775,168.872349426527",
            "TW_,2022-12-11T12:13:59Z,1.40000023834295,3.46067332057388,5.47597178287462",
            "TWD,2022-12-11T12:13:59Z,61.3,113.875749804964,169.637700818976",
            "TW_,2022-12-11T12:14:59Z,3.38788046179512,5.12733444538695,6.66824182620879",
            "TWD,2022-12-11T12:14:59Z,69.1230764285172,100.749911377181,122.578020692882",
            "TW_,2022-12-11T12:15:59Z,3.65485167121151,4.78528320594645,5.79803230434653",
            "TWD,2022-12-11T12:15:59Z,59.5534693988533,96.859574743612,118.783505937497",
            "TW_,2022-12-11T12:16:59Z,3.36161833991098,4.35803004432815,5.41943972663126",
            "TWD,2022-12-11T12:16:59Z,72.6288569801179,102.037691499234,128.935212467236",
            "TW_,2022-12-11T12:17:59Z,3.88698128515194,4.37355518258093,4.94348588381359",
            "TWD,2022-12-11T12:17:59Z,73.1796717259868,101.134142695695,123.641656850304",
            "TW_,2022-12-11T12:18:59Z,3.02679295591319,4.97899821157827,7.5521724334205",
            "TWD,2022-12-11T12:18:59Z,64.0460720939046,91.8360523354645,135.214437398539",
            "TW_,2022-12-11T12:19:59Z,3.40985343817728,5.78648083102087,7.34761883209914",
            "TWD,2022-12-11T12:19:59Z,75.2672074948038,99.362255407491,133.994484644772",
            "TW_,2022-12-11T12:20:59Z,3.49979923826766,4.90465303964003,6.8930585016157",
            "TWD,2022-12-11T12:20:59Z,56.9952665305922,96.4218094840587,126.521174031604",
            "TW_,2022-12-11T12:21:59Z,3.90983752457908,5.53325779079302,6.31965497115997",
            "TWD,2022-12-11T12:21:59Z,78.5159539444267,99.2800579484904,121.708974365201",
            "TW_,2022-12-11T12:22:59Z,2.60952980593101,4.58546006804263,6.37351631083573",
            "TWD,2022-12-11T12:22:59Z,75.9743418125201,104.123730268473,156.603816398462",
            "TW_,2022-12-11T12:23:59Z,2.18139437552066,5.01283774987369,7.19905487675902",
            "TWD,2022-12-11T12:23:59Z,66.5832873227328,101.241138207488,139.816572333385",
            "TW_,2022-12-11T12:24:59Z,1.77032666983637,4.10945704273404,5.8157237519675",
            "TWD,2022-12-11T12:24:59Z,61.9195922244962,102.801330743612,148.603020559744",
            "TW_,2022-12-11T12:25:59Z,3.04996425603005,4.68232404661041,7.7298205006879",
            "TWD,2022-12-11T12:25:59Z,80.2478491738836,113.502545004668,152.205438317749",
            "TW_,2022-12-11T12:26:59Z,2.42997726735688,4.02630195436107,6.19975719452151",
            "TWD,2022-12-11T12:26:59Z,55.2006234783253,111.221852148727,143.603847895992",
            "TW_,2022-12-11T12:27:59Z,2.77446574883083,4.36601662065098,7.43581278868282",
            "TWD,2022-12-11T12:27:59Z,96.4266103585189,123.142503896684,157.03008621813",
            "TW_,2022-12-11T12:28:59Z,1.60681059364767,3.06518699055593,5.27283811935621",
            "TWD,2022-12-11T12:28:59Z,22.1468137601269,110.52175235243,196.693183780455",
            "TW_,2022-12-11T12:29:59Z,1.6383228990505,3.91259920256822,6.59705592748861",
            "TWD,2022-12-11T12:29:59Z,37.1097660738268,123.345403121166,184.293136508412",
            "TW_,2022-12-11T12:30:59Z,1.33868385529939,3.86395889679947,5.86634658651766",
            "TWD,2022-12-11T12:30:59Z,69.755357663457,118.316855112306,161.450731216147",
            "TW_,2022-12-11T12:31:59Z,2.45311911613584,4.80097027900865,7.98985552006888",
            "TWD,2022-12-11T12:31:59Z,47.3100169287061,122.665893672219,161.231021755801",
            "TW_,2022-12-17T21:32:51Z,4.94385757984165,6.16340090869973,7.92300131333968",
            "TWD,2022-12-17T21:32:51Z,84.251503155377,108.269122403326,126.013454060643",
            "TW_,2022-12-17T21:33:51Z,4.33816535411664,6.19953224227806,7.33158418128899",
            "TWD,2022-12-17T21:33:51Z,92.9435167982317,107.679695531467,120.658440720197",
            "TW_,2022-12-17T21:34:51Z,4.00009886350811,5.98190804806049,7.40997125737104",
            "TWD,2022-12-17T21:34:51Z,80.451802154207,106.404263809994,125.881325702005",
            "TW_,2022-12-17T21:35:51Z,4.40983017390481,6.34577856429686,8.37706381641455",
            "TWD,2022-12-17T21:35:51Z,84.0501378804329,106.396212411478,124.965590192698",
            "TW_,2022-12-17T21:36:51Z,3.00940982045162,5.95880561541639,8.06866947545766",
            "TWD,2022-12-17T21:36:51Z,85.7921184581944,107.30543690444,126.271573566903",
            "TW_,2022-12-17T21:37:51Z,4.08000181797842,5.54749158962184,6.95969888721171",
            "TWD,2022-12-17T21:37:51Z,79.170442257275,107.102295984,125.02790331012",
            "TW_,2022-12-17T21:38:51Z,4.99687753281534,6.08305498851538,7.09915031904846",
            "TWD,2022-12-17T21:38:51Z,84.5434102798234,107.63536990845,125.325007263863",
            "TW_,2022-12-17T21:39:51Z,4.9944205560642,6.15013610195566,7.73950949139006",
            "TWD,2022-12-17T21:39:51Z,89.2121497094577,109.805441348882,133.182803393594",
            "TW_,2022-12-17T21:40:51Z,4.33913403043082,5.6327557515357,7.75777278962379",
            "TWD,2022-12-17T21:40:51Z,93.956005993447,111.334540089595,130.592205773166",
            "TW_,2022-12-17T21:41:51Z,4.13949456778428,5.97740764762466,8.21977903745543",
            "TWD,2022-12-17T21:41:51Z,88.1964741646102,110.288700027671,131.182834632939",
            "TW_,2022-12-17T21:42:51Z,5.0637466180207,6.83270012191491,8.37860481277837",
            "TWD,2022-12-17T21:42:51Z,88.5097571222377,108.87645145782,126.563938836087",
            "TW_,2022-12-17T21:43:51Z,3.12699285834448,5.77110192160322,7.75866998268752",
            "TWD,2022-12-17T21:43:51Z,91.6496738940354,111.412983994549,132.098842591703",
            "TW_,2022-12-17T21:44:51Z,4.23962035353814,6.55373975322962,8.33941883759986",
            "TWD,2022-12-17T21:44:51Z,72.2702598481019,101.851332438192,119.191547287325",
            "TW_,2022-12-17T21:45:51Z,5.0224994195567,6.65556093361839,8.10963394866189",
            "TWD,2022-12-17T21:45:51Z,83.6134322681462,101.858680783157,122.677232844386",
            "TW_,2022-12-17T21:46:51Z,5.20999367410202,6.72044620590701,8.12872487249249",
            "TWD,2022-12-17T21:46:51Z,85.1232421602788,102.195074669888,120.859058038347",
            "TW_,2022-12-17T21:47:51Z,5.13302462308311,7.01473205333765,8.33997949997342",
            "TWD,2022-12-17T21:47:51Z,80.6949363645001,101.927742715817,119.161350437637",
            "TW_,2022-12-17T21:48:51Z,4.79999137491537,6.85077535272537,8.54971178486473",
            "TWD,2022-12-17T21:48:51Z,83.7065562682361,104.254066045991,117.797569714011",
            "TW_,2022-12-17T21:49:51Z,5.34881514657999,7.2325535977495,8.76492873926815",
            "TWD,2022-12-17T21:49:51Z,91.9237896523937,107.046997309747,121.089410151882",
            "TW_,2022-12-17T21:50:51Z,4.9382689332946,6.26933521453511,8.25996844548123",
            "TWD,2022-12-17T21:50:51Z,86.5026496248496,109.074449652291,124.821131788809",
            "TW_,2022-12-17T21:51:51Z,4.09897768461157,6.51349446685551,8.94783508055487",
            "TWD,2022-12-17T21:51:51Z,87.8748286158941,110.388854396163,130.17481163287",
            "TW_,2022-12-17T21:52:51Z,3.99940884252258,5.63993297420574,7.8699721400383",
            "TWD,2022-12-17T21:52:51Z,81.0643945956964,113.648851674722,139.323389981468",
            "TW_,2022-12-17T21:53:51Z,4.50202201316442,6.29549521759063,7.8298161307216",
            "TWD,2022-12-17T21:53:51Z,89.8343890971811,112.650096407084,131.983751646563",
            "TW_,2022-12-17T21:54:51Z,5.32945848078485,6.73776420135016,8.54689133452666",
            "TWD,2022-12-17T21:54:51Z,84.2950660824156,109.202146923601,132.188555923915",
            "TW_,2022-12-17T21:55:51Z,4.21928041470572,6.380473682008,8.74858407099356",
            "TWD,2022-12-17T21:55:51Z,85.7173566488107,108.729766026722,126.999892739187",
            "TW_,2022-12-17T21:56:51Z,4.10074900147179,6.24487331146079,7.77994257158446",
            "TWD,2022-12-17T21:56:51Z,89.1841025016898,105.746729597764,128.6",
            "TW_,2022-12-17T21:57:51Z,4.11997604953065,6.34036818925782,8.47998518400386",
            "TWD,2022-12-17T21:57:51Z,81.4627059785552,102.864575170079,127.326793557692",
            "TW_,2022-12-17T21:58:51Z,3.67455181485362,5.84117966657622,8.14528802880339",
            "TWD,2022-12-17T21:58:51Z,85.983727264402,107.619170098187,136.755102378911",
            "TW_,2022-12-17T21:59:51Z,5.10952931933864,6.82954164277335,8.2992387447055",
            "TWD,2022-12-17T21:59:51Z,84.6469119931605,107.781402715676,134.074594778654",
            "TW_,2022-12-17T22:00:51Z,3.45751033579556,5.94161618906462,7.86799097670559",
            "TWD,2022-12-17T22:00:51Z,86,110.653560019826,129.993317125003",
            "TW_,2022-12-17T22:01:51Z,4.5094912492,6.13503287634527,7.99319707336181",
            "TWD,2022-12-17T22:01:51Z,86.9617011079046,108.891121075388,125.524469202108",
            "TW_,2022-12-17T22:02:51Z,4.42946703887186,6.72693274328697,8.70963451791265",
            "TWD,2022-12-17T22:02:51Z,94.1558252846195,107.493484499531,119.281164515478",
            "TW_,2022-12-17T22:03:51Z,3.50000059526721,5.75107712069287,7.42987160083935",
            "TWD,2022-12-17T22:03:51Z,83.5580993434255,107.141521217026,131.502530902879",
            "TW_,2022-12-17T22:04:51Z,4.17916550714614,5.87541575435583,7.92945380168886",
            "TWD,2022-12-17T22:04:51Z,78.2611636434473,110.158179174689,131.294393604246",
            "TW_,2022-12-17T22:05:51Z,4.02988541254549,5.67019736428807,7.88902990405648",
            "TWD,2022-12-17T22:05:51Z,93.2421291812686,116.500636857019,137.357848260381",
            "TW_,2022-12-17T22:06:51Z,3.73989733904131,5.71339755886681,7.81064313500097",
            "TWD,2022-12-17T22:06:51Z,90.1235570991323,114.469402519465,137.681874462985",
            "TW_,2022-12-17T22:07:51Z,4.23933795720024,5.74605231286949,7.84440096995842",
            "TWD,2022-12-17T22:07:51Z,91.1682699153712,114.865169346753,132.873782570774",
            "TW_,2022-12-17T22:08:51Z,3.81241497575253,5.71472564938505,7.88542652724711",
            "TWD,2022-12-17T22:08:51Z,94.8003745448813,114.584795449737,133.890060148941",
            "TW_,2022-12-17T22:09:51Z,3.02994938938521,5.24501424517562,6.84748944287083",
            "TWD,2022-12-17T22:09:51Z,92.9023202093124,115.889442313331,148.461740203508",
            "TW_,2022-12-17T22:10:51Z,3.91942517155075,5.96357885006583,7.88035232578449",
            "TWD,2022-12-17T22:10:51Z,95.2912822870871,116.140166050325,136.640246269234",
            "TW_,2022-12-17T22:11:51Z,4.27594182820098,6.11259863419617,7.94977269016281",
            "TWD,2022-12-17T22:11:51Z,93.0223277437998,111.725999360898,135.226865926748",
            "TW_,2022-12-17T22:12:51Z,4.67091475414888,6.25784906742592,8.25444590101531",
            "TWD,2022-12-17T22:12:51Z,86.6658859408326,113.728062629153,137.581882166308",
            "TW_,2022-12-17T22:13:51Z,4.52992780974956,6.72630027084301,8.60354972178243",
            "TWD,2022-12-17T22:13:51Z,96.810904161153,113.216082819747,133.131011108063",
            "TW_,2022-12-17T22:14:51Z,3.93209106187146,6.44865883559382,8.64810161379683",
            "TWD,2022-12-17T22:14:51Z,78.8532033649352,110.021761909192,143.320912173866",
            "TW_,2022-12-17T22:15:51Z,3.98905161408608,5.80609507975064,8.35922698560719",
            "TWD,2022-12-17T22:15:51Z,73.0025163955514,109.306939919612,132.369427692173",
            "TW_,2022-12-17T22:16:51Z,4.79871497245506,7.04999644834625,9.2892624069609",
            "TWD,2022-12-17T22:16:51Z,87.4026496248497,110.505489685542,132.369427692173",
            "TW_,2022-12-17T22:17:51Z,5.04249848665971,6.44708274921855,8.97684940616032",
            "TWD,2022-12-17T22:17:51Z,97.1150913435108,110.821715902364,128.167028288358",
            "TW_,2022-12-17T22:18:51Z,5.03998645900015,6.28264130129837,8.41996131575144",
            "TWD,2022-12-17T22:18:51Z,90.1740607150806,106.593993010477,123.92499549355",
            "TW_,2022-12-17T22:19:51Z,4.03972825688138,5.97023415033356,8.31698089172403",
            "TWD,2022-12-17T22:19:51Z,89.5121508763522,107.717397234975,126.554815155783",
            "TW_,2022-12-17T22:20:51Z,4.4475711541536,6.1522132520225,8.97969427611466",
            "TWD,2022-12-17T22:20:51Z,87.7,108.157461979533,127.753578239686",
            "TW_,2022-12-17T22:21:51Z,4.60987248907424,5.9543078226202,7.71999657055673",
            "TWD,2022-12-17T22:21:51Z,85.6475678143157,109.119812305587,133.456377126378",
            "TW_,2022-12-17T22:22:51Z,4.72157995972751,6.08211924835298,8.21956138840708",
            "TWD,2022-12-17T22:22:51Z,93.6525214751022,110.149060344925,129.913287213503",
            "TW_,2022-12-17T22:23:51Z,3.63865190615808,5.39021106692826,7.13905634131383",
            "TWD,2022-12-17T22:23:51Z,80.0767159512657,109.516820056644,131.366025764008",
            "TW_,2022-12-17T22:24:51Z,3.8474184486096,5.84962787270469,7.96999530787796",
            "TWD,2022-12-17T22:24:51Z,86.7564629971138,107.311863693854,122.184473114698",
            "TW_,2022-12-17T22:25:51Z,3.20945111134359,5.29081651160863,7.47559192348902",
            "TWD,2022-12-17T22:25:51Z,95.8741545444229,111.929254233228,126.600500749367",
            "TW_,2022-12-17T22:26:51Z,4.0996005570527,5.97733268063411,7.74797729377153",
            "TWD,2022-12-17T22:26:51Z,91.5435822479421,110.595973884613,132.692301293098",
            "TW_,2022-12-17T22:27:51Z,3.52599401454183,5.19357285203078,7.269698737694",
            "TWD,2022-12-17T22:27:51Z,93.5572753411912,114.136115075073,138.943993913509",
            "TW_,2022-12-17T22:28:51Z,4.07893310905804,5.32178278650505,7.52019224417048",
            "TWD,2022-12-17T22:28:51Z,82.0287804619945,117.128982783092,143.239581857749",
            "TW_,2022-12-17T22:29:51Z,2.64484134793935,4.62560406757216,6.35614578513048",
            "TWD,2022-12-17T22:29:51Z,91.5841488910001,113.96255999518,137.336350369752",
            "TW_,2022-12-17T22:30:51Z,3.22737664177728,4.91364650225119,6.95472527841556",
            "TWD,2022-12-17T22:30:51Z,74.9124578005067,113.720527203829,139.035022231323",
            "TW_,2022-12-17T22:31:51Z,4.0591389569036,5.86628282341575,7.40971162326904",
            "TWD,2022-12-17T22:31:51Z,94.7416338776441,112.790044358221,138.028931665906",
            "TW_,2022-12-17T22:32:51Z,4.35490137014486,5.71876739851618,7.77867384456598",
            "TWD,2022-12-17T22:32:51Z,92.4579504448294,112.834278330264,128.333054917256",
            "TW_,2022-12-17T22:33:51Z,3.55995132625456,5.97503036212724,8.29911833477349",
            "TWD,2022-12-17T22:33:51Z,82.1952636734349,105.782383796684,123.184336453542",
            "TW_,2022-12-17T22:34:51Z,3.3072577286632,5.11550566902298,8.18954282683",
            "TWD,2022-12-17T22:34:51Z,91.4821133383103,108.371638213827,130.804942089856",
            "TW_,2022-12-17T22:35:51Z,4.42773179164745,5.57350011352969,8.10977868315197",
            "TWD,2022-12-17T22:35:51Z,93.731161940781,111.169701103504,135.060047856464",
            "TW_,2022-12-17T22:36:51Z,4.44949428433289,6.14658292749916,8.47531944622483",
            "TWD,2022-12-17T22:36:51Z,92.1774984145696,109.692100460054,130.357093231",
            "TW_,2022-12-17T22:37:51Z,4.52864936715248,5.8588467476658,7.85883095623948",
            "TWD,2022-12-17T22:37:51Z,76.6415483985435,105.537376527428,133.430693357769",
            "TW_,2022-12-17T22:38:51Z,3.60121307084112,5.71134479656655,7.17963548458964",
            "TWD,2022-12-17T22:38:51Z,80.5814123773897,107.705744469171,131.141607528479",
            "TW_,2022-12-17T22:39:51Z,4.21922901638914,5.77999533303417,7.99737561751696",
            "TWD,2022-12-17T22:39:51Z,90.0518175316662,106.207310559199,128.989277318838",
            "TW_,2022-12-17T22:40:51Z,4.20000085816695,5.61061817905049,7.26992899094901",
            "TWD,2022-12-17T22:40:51Z,75.689609638559,104.817737706844,130.469054723413",
            "TW_,2022-12-17T22:41:51Z,4.45161063253566,6.24638060317743,7.51735762956345",
            "TWD,2022-12-17T22:41:51Z,87.5250825712963,103.277487928874,120.722036674181",
            "TW_,2022-12-17T22:42:51Z,4.40992564493553,6.40726752617585,8.04625205027968",
            "TWD,2022-12-17T22:42:51Z,85.2015940959039,105.040516258055,120.503800475332",
            "TW_,2022-12-17T22:43:51Z,3.98000499682631,6.41509741379652,8.08986407037037",
            "TWD,2022-12-17T22:43:51Z,81.1682034715842,102.812107970351,122.023799355439",
            "TW_,2022-12-17T22:44:51Z,4.22001650785618,6.53087632856896,8.95832193550118",
            "TWD,2022-12-17T22:44:51Z,87.5260894048395,105.109832943475,120.290848324039",
            "TW_,2022-12-17T22:45:51Z,4.79989477267584,7.46621346985807,9.98981533228089",
            "TWD,2022-12-17T22:45:51Z,77.8155982384962,105.251494297361,124.874497124663",
            "TW_,2022-12-17T22:46:51Z,4.93913456588548,7.53287505492184,9.44663168155516",
            "TWD,2022-12-17T22:46:51Z,90.0518175316662,104.278796535017,120.098857674371",
            "TW_,2022-12-17T22:47:51Z,4.48477274184724,6.31936652730792,8.62997505913031",
            "TWD,2022-12-17T22:47:51Z,81.9576735942639,105.885545482861,125.467794890267",
            "TW_,2022-12-17T22:48:51Z,4.93642659923052,6.74845970816469,8.99963259451144",
            "TWD,2022-12-17T22:48:51Z,83.5982753223813,110.110994803353,135.296866465272",
            "TW_,2022-12-17T22:49:51Z,4.01795454769084,6.19327495013331,8.45492579003044",
            "TWD,2022-12-17T22:49:51Z,88.1227527113735,114.942794736017,136.218001036569",
            "TW_,2022-12-17T22:50:51Z,3.32906357212136,5.56749424312665,8.54926637600674",
            "TWD,2022-12-17T22:50:51Z,87.9898782369513,117.77929916785,140.204542857181",
            "TW_,2022-12-17T22:51:51Z,3.82951275161386,5.1041383705032,7.05455257243908",
            "TWD,2022-12-17T22:51:51Z,104.410980731185,119.860961301049,137.669127086255",
            "TW_,2022-12-17T22:52:51Z,3.42412589616756,5.78065878744496,7.22815825898413",
            "TWD,2022-12-17T22:52:51Z,102.669656871541,121.877693430315,157.938850297779",
            "TW_,2022-12-17T22:53:51Z,3.7570223305127,6.37449853176941,8.21794246345475",
            "TWD,2022-12-17T22:53:51Z,88.1932637013875,119.949123460092,146.357738984286",
            "TW_,2022-12-17T22:54:51Z,5.01944993140007,6.72607268595874,8.37373944469674",
            "TWD,2022-12-17T22:54:51Z,93.9159954846584,116.196117618123,129.900555519186",
            "TW_,2022-12-17T22:55:51Z,5.54647102467372,7.11834653719227,8.66611958362001",
            "TWD,2022-12-17T22:55:51Z,87.9651256939951,113.542425480389,131.616930437986",
            "TW_,2022-12-17T22:56:51Z,3.34742463274894,5.24581516855975,8.14941501088859",
            "TWD,2022-12-17T22:56:51Z,80.8922917990519,112.2189172192,137.7",
            "TW_,2022-12-17T22:57:51Z,5.03631415208807,7.39205737025143,9.738956578342",
            "TWD,2022-12-17T22:57:51Z,91.9886879766227,113.812115759461,142.6",
            "TW_,2022-12-17T22:58:51Z,3.94932213052151,6.32369478532152,10.4596167680083",
            "TWD,2022-12-17T22:58:51Z,87.4557211479995,112.260565191909,139.054882388289",
            "TW_,2022-12-17T22:59:51Z,3.24910564784984,6.66382194777376,8.66778885294615",
            "TWD,2022-12-17T22:59:51Z,83.7329956025305,110.414254343182,134.705983233505",
            "TW_,2022-12-17T23:00:51Z,3.82987993919503,6.22275608141326,9.22066378689967",
            "TWD,2022-12-17T23:00:51Z,93.9619077254633,112.35037937941,135.790812007224",
            "TW_,2022-12-17T23:01:51Z,4.19423781632679,6.43410490017865,8.54568009359246",
            "TWD,2022-12-17T23:01:51Z,93.6512831399443,115.706867073917,138.4",
            "TW_,2022-12-17T23:02:51Z,3.43860239340961,6.18762274401884,9.6572670573524",
            "TWD,2022-12-17T23:02:51Z,85.7009316207567,111.581716285792,138.266555731098",
            "TW_,2022-12-17T23:03:51Z,4.38559373820004,6.43382920814691,8.82973684739197",
            "TWD,2022-12-17T23:03:51Z,93.7458131104063,112.197839653069,134.121139664125",
            "TW_,2022-12-17T23:04:51Z,4.80121093858385,7.2350360863971,9.44934471644971",
            "TWD,2022-12-17T23:04:51Z,92.2,111.926385793162,126.750658914218",
            "TW_,2022-12-17T23:05:51Z,2.62488871175388,5.28075526413039,8.02321650126996",
            "TWD,2022-12-17T23:05:51Z,82.4200823460438,115.483004015681,145.948476057004",
            "TW_,2022-12-17T23:06:51Z,3.30911043996107,5.99669457360249,7.79764607346737",
            "TWD,2022-12-17T23:06:51Z,89.5,111.229322076107,131.853851390447",
            "TW_,2022-12-17T23:07:51Z,3.80875500608322,5.87836218811224,7.98247911864023",
            "TWD,2022-12-17T23:07:51Z,81.2397362452074,109.342985896882,129.240380430459",
            "TW_,2022-12-17T23:08:51Z,3.16481638645225,5.81960021806649,9.15978513073274",
            "TWD,2022-12-17T23:08:51Z,80.8621608003472,111.272561142163,139.538368998532",
            "TW_,2022-12-17T23:09:51Z,2.6459171241269,5.97888773075809,8.49992808732243",
            "TWD,2022-12-17T23:09:51Z,91.6276993937765,113.02939505869,127.052114770819",
            "TW_,2022-12-17T23:10:51Z,4.11884301619269,6.71846331444096,9.94479150566378",
            "TWD,2022-12-17T23:10:51Z,86.8763369829185,110.504021314844,143.589557770614",
            "TW_,2022-12-17T23:11:51Z,3.83321812077446,6.21480771641375,8.99972622212902",
            "TWD,2022-12-17T23:11:51Z,89.8301600922166,117.393919553115,139.311946924887",
            "TW_,2022-12-17T23:12:51Z,4.53115082473525,7.04822373792401,9.44592097640558",
            "TWD,2022-12-17T23:12:51Z,87.2935168238134,110.30299466578,132.395765516271",
            "TW_,2022-12-17T23:13:51Z,4.49003116484464,6.12325294806219,8.72933123652758",
            "TWD,2022-12-17T23:13:51Z,88.1967123359768,114.54914189913,148.221264808287",
            "TW_,2022-12-17T23:14:51Z,4.40952804525645,6.52204709945931,9.21919573293031",
            "TWD,2022-12-17T23:14:51Z,87.1441356588491,107.397898577829,127.90591004047",
            "TW_,2022-12-17T23:15:51Z,4.33686355824815,6.76484766400862,8.54997949716662",
            "TWD,2022-12-17T23:15:51Z,89.6015579373142,110.633491103123,147.578790356854",
            "TW_,2022-12-17T23:16:51Z,3.64031125560915,5.54418354354143,7.9097784534982",
            "TWD,2022-12-17T23:16:51Z,83.3748613657816,110.877532490937,147.578790356854",
            "TW_,2022-12-17T23:17:51Z,3.71378602890082,7.11589802180573,9.4699174533413",
            "TWD,2022-12-17T23:17:51Z,91.4496441454471,110.84145627229,129",
            "TW_,2022-12-17T23:18:51Z,6.21985607786762,8.34857607459428,10.5594892616073",
            "TWD,2022-12-17T23:18:51Z,85.4108570657695,109.299880708007,136.345182402375",
            "TW_,2022-12-17T23:19:51Z,3.99983038509478,6.78361185870115,9.05840792734551",
            "TWD,2022-12-17T23:19:51Z,85.3,107.559794356271,131.310674000768",
            "TW_,2022-12-17T23:20:51Z,6.23926875176502,8.31597461944016,10.729525431783",
            "TWD,2022-12-17T23:20:51Z,90.3861931638145,108.645659762476,124.190486184765",
            "TW_,2022-12-17T23:21:51Z,4.11882358524114,6.91594650763587,9.65735626122481",
            "TWD,2022-12-17T23:21:51Z,86.24471751315,108.283291543891,126.131902885262",
            "TW_,2022-12-17T23:22:51Z,3.9481212899556,8.22008122622849,11.7096715321718",
            "TWD,2022-12-17T23:22:51Z,80.7105898481179,110.693527571677,145.6",
            "TW_,2022-12-17T23:23:51Z,5.29001163285822,7.42403772877911,10.5766901816278",
            "TWD,2022-12-17T23:23:51Z,86.2033353395919,111.928665666885,130.636962393915",
            "TW_,2022-12-17T23:24:51Z,5.26195061605455,8.84928605554015,11.8799116244365",
            "TWD,2022-12-17T23:24:51Z,88.2473820939481,107.037413770113,133.089075046657",
            "TW_,2022-12-17T23:25:51Z,4.31874061759168,7.62008656843354,11.4290247497868",
            "TWD,2022-12-17T23:25:51Z,68.476896439573,110.671854184647,137.303087239385",
            "TW_,2022-12-17T23:26:51Z,5.43659596145767,8.55587879143822,11.6460366943191",
            "TWD,2022-12-17T23:26:51Z,87.2948023868244,109.64964664019,138.300464071086",
            "TW_,2022-12-17T23:27:51Z,4.81795052020484,7.20842256053771,11.0497046618358",
            "TWD,2022-12-17T23:27:51Z,76.8,107.595601927508,125.240948859578",
            "TW_,2022-12-17T23:28:51Z,3.53951343517206,6.44578678225346,10.6498878121383",
            "TWD,2022-12-17T23:28:51Z,85.6897845899527,109.834450031786,133.144684740263",
            "TW_,2022-12-17T23:29:51Z,4.81583084210091,7.1416302316501,10.3718356985245",
            "TWD,2022-12-17T23:29:51Z,85.6897845899527,112.615299704816,132.853103492495",
            "TW_,2022-12-17T23:30:51Z,4.11856101588756,6.56196818993893,8.29622682106357",
            "TWD,2022-12-17T23:30:51Z,82.0560383121523,110.167511995871,138.003858965813",
            "TW_,2022-12-17T23:31:51Z,4.35770758348052,6.57748888027943,8.78213669331354",
            "TWD,2022-12-17T23:31:51Z,105.837236070174,121.26774160407,137.872843897256",
            "TW_,2022-12-17T23:32:51Z,2.81945153637964,5.44570373738622,7.65963519591606",
            "TWD,2022-12-17T23:32:51Z,85.7000514876274,110.352010712476,136.823604988998",
            "TW_,2022-12-17T23:33:51Z,4.11766060813623,5.98109981189429,8.5634240236692",
            "TWD,2022-12-17T23:33:51Z,87.8984396635644,115.529964181982,138.003895431277",
            "TW_,2022-12-17T23:34:51Z,4.11846543707575,6.48599177788352,10.9098291144017",
            "TWD,2022-12-17T23:34:51Z,90.5,112.462877582216,130.991080083934",
            "TW_,2022-12-17T23:35:51Z,3.7640356943118,6.61697084785089,9.05854303567663",
            "TWD,2022-12-17T23:35:51Z,92.5281688900803,112.240594691515,137.048117928955",
            "TW_,2022-12-17T23:36:51Z,4.14452377217084,6.30720195897888,8.88726613247414",
            "TWD,2022-12-17T23:36:51Z,89.0355581030599,110.210452383078,124.517829285088",
            "TW_,2022-12-17T23:37:51Z,3.10899664162187,6.19093267145405,8.93903606390534",
            "TWD,2022-12-17T23:37:51Z,91.4845666911782,112.688950029296,134.531663620416",
            "TW_,2022-12-17T23:38:51Z,4.52846398423361,7.20113438142506,10.6393633385464",
            "TWD,2022-12-17T23:38:51Z,88.9399431511621,105.187545422433,137.017917483945",
            "TW_,2022-12-17T23:39:51Z,4.41107002300052,7.50614973216601,10.4997754541553",
            "TWD,2022-12-17T23:39:51Z,90.3600133770067,107.786607639365,126.063163245046",
            "TW_,2022-12-17T23:40:51Z,5.39988876170463,7.14887405341125,9.17669333325814",
            "TWD,2022-12-17T23:40:51Z,77.0617743051394,101.495023112938,120.365829473081",
            "TW_,2022-12-17T23:41:51Z,5.01985884719532,8.14510462270563,9.96943409241314",
            "TWD,2022-12-17T23:41:51Z,88.4254456259428,104.823171189177,121.108067984719",
            "TW_,2022-12-17T23:42:51Z,4.62882212316815,6.82690069743519,8.97981527860549",
            "TWD,2022-12-17T23:42:51Z,81.4973811705509,102.518474560252,124.87780249693",
            "TW_,2022-12-17T23:43:51Z,6.11966032639218,7.73429083093087,9.63872647230267",
            "TWD,2022-12-17T23:43:51Z,78.150742384472,99.7366071201826,123.447909490078",
            "TW_,2022-12-17T23:44:51Z,5.62075957927087,7.45651106873427,9.44987667321848",
            "TWD,2022-12-17T23:44:51Z,70.844085982767,96.589982021132,109.648186878153",
            "TW_,2022-12-17T23:45:51Z,5.53955808637207,7.65868218064996,9.71984756913952",
            "TWD,2022-12-17T23:45:51Z,86.2549994514222,99.4830436539553,108.9",
            "TW_,2022-12-17T23:46:51Z,5.72013813137001,7.36398107709409,8.91998600148585",
            "TWD,2022-12-17T23:46:51Z,82.3616757705947,97.4075695661443,111.039233208294",
            "TW_,2022-12-17T23:47:51Z,5.82994567148224,8.04140832750577,9.87686679142869",
            "TWD,2022-12-17T23:47:51Z,80.7324298209687,98.6700087002274,118.085261056035",
            "TW_,2022-12-17T23:48:51Z,6.71111424886608,8.65548371286035,10.9496784586337",
            "TWD,2022-12-17T23:48:51Z,80.4919195185656,99.4556848695094,114.918366879551",
            "TW_,2022-12-17T23:49:51Z,6.80299706341826,8.84465657373069,10.8296584808424",
            "TWD,2022-12-17T23:49:51Z,84.5730039514991,99.8125048876497,108.87446339481",
            "TW_,2022-12-17T23:50:51Z,6.41993872089533,8.1966977776675,10.0498119876027",
            "TWD,2022-12-17T23:50:51Z,86.6017655595359,98.9969393520867,116.171539702969",
            "TW_,2022-12-17T23:51:51Z,4.95949342655504,7.91957655133932,11.7591821066709",
            "TWD,2022-12-17T23:51:51Z,82.164108106075,102.482530434546,114.989052318131",
            "TW_,2022-12-17T23:52:51Z,5.49982983107686,7.81185070647372,10.0890058198935",
            "TWD,2022-12-17T23:52:51Z,89.5573942307883,102.480529898925,117.902098201101",
            "TW_,2022-12-17T23:53:51Z,5.32876267063547,7.83091035203832,9.8399453179856",
            "TWD,2022-12-17T23:53:51Z,81.2105898481179,102.657102116492,126.841754937615",
            "TW_,2022-12-17T23:54:51Z,3.83932425464411,6.53585536068271,9.63999754830025",
            "TWD,2022-12-17T23:54:51Z,86.4850983495713,105.915113917699,121.194918449406",
            "TW_,2022-12-17T23:55:51Z,4.62978322774619,6.97889571810853,9.40999693888778",
            "TWD,2022-12-17T23:55:51Z,84.7134322681462,104.463423738071,123.711987694984",
            "TW_,2022-12-17T23:56:51Z,6.00966659528485,7.95163392299707,9.91894996259237",
            "TWD,2022-12-17T23:56:51Z,86.2342544915661,102.913115242718,115.321315589854",
            "TW_,2022-12-17T23:57:51Z,4.42996246059907,6.79537307002854,9.34722872860572",
            "TWD,2022-12-17T23:57:51Z,85.1381951351179,108.491115445803,125.743897186593",
            "TW_,2022-12-17T23:58:51Z,5.45813158981227,8.29845182015616,10.4596971363459",
            "TWD,2022-12-17T23:58:51Z,83.8477903322796,103.598632609055,120.180695802826",
            "TW_,2022-12-17T23:59:51Z,4.33772657270104,6.06775317459269,9.28877629025983",
            "TWD,2022-12-17T23:59:51Z,90.295680308181,107.643749600144,127.941820581565",
            "TW_,2022-12-18T00:00:51Z,4.34993251790244,6.3527222052809,8.4584702274788",
            "TWD,2022-12-18T00:00:51Z,72.1215862289613,107.879591248409,131.07299234627",
            "TW_,2022-12-18T00:01:51Z,4.20002943236646,6.15717438738119,8.70869886469435",
            "TWD,2022-12-18T00:01:51Z,89.7648596776975,110.735081018527,132.614093475657",
            "TW_,2022-12-18T00:02:51Z,4.92564151767641,6.99561272949207,8.74994025199642",
            "TWD,2022-12-18T00:02:51Z,92.6855753515038,107.436105078407,123.963248847343",
            "TW_,2022-12-18T00:03:51Z,3.30742243696689,6.00419478572151,8.52889970928339",
            "TWD,2022-12-18T00:03:51Z,92.4340453953864,111.669364120174,128.729390774298",
            "TW_,2022-12-18T00:04:51Z,5.63905961117751,7.01616344897557,8.31864319898911",
            "TWD,2022-12-18T00:04:51Z,90.4264014357611,108.715088899824,126.920331447133",
            "TW_,2022-12-18T00:05:51Z,3.8289534313278,6.36811279197549,9.40985085224687",
            "TWD,2022-12-18T00:05:51Z,86.8858167443218,106.001631466526,121.740572228201",
            "TW_,2022-12-18T00:06:51Z,4.44993032195862,6.21856556224221,8.54900208708298",
            "TWD,2022-12-18T00:06:51Z,88.7336835139313,107.508995538807,126.231446594102",
            "TW_,2022-12-18T00:07:51Z,3.71000018949774,6.14424880103915,8.72984848359644",
            "TWD,2022-12-18T00:07:51Z,72.8057855282515,106.686963296817,126.076082787384",
            "TW_,2022-12-18T00:08:51Z,5.39997269214236,6.75568328438654,9.67487902948831",
            "TWD,2022-12-18T00:08:51Z,87.4344019150363,105.701227703252,123.14681361944",
            "TW_,2022-12-18T00:09:51Z,3.74406916228954,6.71516388692401,8.63998250505127",
            "TWD,2022-12-18T00:09:51Z,75.1428275212114,104.571168169902,132.788193844145",
            "TW_,2022-12-18T00:10:51Z,4.62956764366371,6.9188605541492,9.79922901965241",
            "TWD,2022-12-18T00:10:51Z,80.6472695380288,102.774590205873,126.783153283107",
            "TW_,2022-12-18T00:11:51Z,4.79993871784461,6.45264696022964,8.70239871497967",
            "TWD,2022-12-18T00:11:51Z,80.3734354160453,105.386687530228,123.314883297139",
            "TW_,2022-12-18T00:12:51Z,3.91078826727908,6.55523380780035,8.74886888333337",
            "TWD,2022-12-18T00:12:51Z,86.1393672754735,104.099846657393,137.545182402375",
            "TW_,2022-12-18T00:13:51Z,4.41327231755168,7.06978321054555,9.92965859495297",
            "TWD,2022-12-18T00:13:51Z,81.810593864417,103.532497784752,124.99691968323",
            "TW_,2022-12-18T00:14:51Z,3.91117016894827,6.03188665056305,8.37740332139956",
            "TWD,2022-12-18T00:14:51Z,73.282496456114,98.0313473569466,116.952025666582",
            "TW_,2022-12-18T00:15:51Z,6.08000179121888,7.53376506656702,9.01992572214015",
            "TWD,2022-12-18T00:15:51Z,87.7,98.2471869734109,111.951581309388",
            "TW_,2022-12-18T00:16:51Z,5.63974487308802,7.35438427457605,9.22999368614048",
            "TWD,2022-12-18T00:16:51Z,82.4545736089891,102.857870176863,126.27136287044",
            "TW_,2022-12-18T00:17:51Z,5.49907991653056,6.92269756047963,8.14967313740399",
            "TWD,2022-12-18T00:17:51Z,85.6446951347116,103.900710488949,123.739332803264",
            "TW_,2022-12-18T00:18:51Z,4.60841788086663,6.55294240238183,8.84964235917308",
            "TWD,2022-12-18T00:18:51Z,83.7865913984915,105.046027867759,127.191164244204",
            "TW_,2022-12-18T00:19:51Z,3.14972962728173,6.05318023479945,8.95981579174652",
            "TWD,2022-12-18T00:19:51Z,82.8470610036645,108.905858839051,138.719727711776",
            "TW_,2022-12-18T00:20:51Z,5.12966054500679,8.05891860961946,9.81672479462575",
            "TWD,2022-12-18T00:20:51Z,99.5055019957281,110.272848048117,123.731380948608",
            "TW_,2022-12-18T00:21:51Z,3.99956640677192,7.06743610469929,9.94819912547983",
            "TWD,2022-12-18T00:21:51Z,90.9286139875098,112.563780206978,136.523880225368",
            "TW_,2022-12-18T00:22:51Z,3.50001166454366,6.76999399123865,9.01962391838086",
            "TWD,2022-12-18T00:22:51Z,91.22553660519,113.516326371533,133.06910410191",
            "TW_,2022-12-18T00:23:51Z,4.34030649644793,6.60770661783281,8.51991429173427",
            "TWD,2022-12-18T00:23:51Z,88.0321562934765,110.612122715077,134.486448652377",
            "TW_,2022-12-18T00:24:51Z,3.62118340217811,6.24540634041877,8.16729938130516",
            "TWD,2022-12-18T00:24:51Z,92.6225842748272,110.437049043029,126.956202442235",
            "TW_,2022-12-18T00:25:51Z,3.92997751011564,5.81237480190126,8.35909831919881",
            "TWD,2022-12-18T00:25:51Z,82.7429301339043,111.479897972157,131.796514887213",
            "TW_,2022-12-18T00:26:51Z,4.8563584776405,6.83026815141026,9.26975471966468",
            "TWD,2022-12-18T00:26:51Z,90.1579315314435,110.497356718161,139.674078518384",
            "TW_,2022-12-18T00:27:51Z,4.60983120104241,6.66287847299182,8.82914507225518",
            "TWD,2022-12-18T00:27:51Z,91.0516083844751,106.062749238996,127.537304668495",
            "TW_,2022-12-18T00:28:51Z,5.05881015855894,7.07029619618829,8.84926599248852",
            "TWD,2022-12-18T00:28:51Z,82.0573438318849,104.474994136605,124.01541718482",
            "TW_,2022-12-18T00:29:51Z,5.45985317506112,6.54735233049201,8.86928415000057",
            "TWD,2022-12-18T00:29:51Z,86.9874368601311,103.91372351444,121.652844779758",
            "TW_,2022-12-18T00:30:51Z,4.7193419867041,6.87318853379391,9.52996124579828",
            "TWD,2022-12-18T00:30:51Z,75.975467876164,103.965561412245,131.511237824558",
            "TW_,2022-12-18T00:31:51Z,3.94569581481826,7.44047760875426,10.0497186659012",
            "TWD,2022-12-18T00:31:51Z,86.3379267528093,105.490458890562,123.937503281405",
            "TW_,2022-12-18T00:32:51Z,4.25641719429683,7.03665416844015,9.61804963194496",
            "TWD,2022-12-18T00:32:51Z,87.7368505787856,102.087461342775,120.762689623095",
            "TW_,2022-12-18T00:33:51Z,4.4100641166758,7.34725936529063,8.84934444093153",
            "TWD,2022-12-18T00:33:51Z,82.6440883891482,102.215169685665,116.957369755267",
            "TW_,2022-12-18T00:34:51Z,3.8096053391732,5.5894532238517,8.37651313330971",
            "TWD,2022-12-18T00:34:51Z,86.4559226690347,104.045392438348,127.21449813502",
            "TW_,2022-12-18T00:35:51Z,4.3198952304485,6.10626533838535,8.68997117172668",
            "TWD,2022-12-18T00:35:51Z,79.8855776657705,101.299309631086,125.586039378942",
            "TW_,2022-12-18T00:36:51Z,4.60967605190142,6.17322570308364,7.96973475583783",
            "TWD,2022-12-18T00:36:51Z,90.0546663472898,103.062477225181,124.719100546604",
            "TW_,2022-12-18T00:37:51Z,5.39995186010404,6.99434917381555,8.16941756645389",
            "TWD,2022-12-18T00:37:51Z,83.1471733898673,101.154332163209,119.881729016587",
            "TW_,2022-12-18T00:38:51Z,5.04000025744599,6.4580125132211,8.16992063566778",
            "TWD,2022-12-18T00:38:51Z,79.2608593466508,96.3796245637639,112.552893199309",
            "TW_,2022-12-18T00:39:51Z,4.84062548391048,6.55560472003893,7.59997238629356",
            "TWD,2022-12-18T00:39:51Z,67.8062176311614,100.043545323361,115.475697336422",
            "TW_,2022-12-18T00:40:51Z,4.52970456408615,6.85094247370608,8.90954457328656",
            "TWD,2022-12-18T00:40:51Z,79.2661451332405,96.793758926559,111.430864318194",
            "TW_,2022-12-18T00:41:51Z,5.10873873301203,7.02325885221296,9.24983460874803",
            "TWD,2022-12-18T00:41:51Z,82.1905847251397,98.8000900579763,119.621446704749",
            "TW_,2022-12-18T00:42:51Z,5.49963416353405,7.78742289429068,9.87981582873203",
            "TWD,2022-12-18T00:42:51Z,79.851577410332,102.88346089766,118.500382853114",
            "TW_,2022-12-18T00:43:51Z,4.78249848967343,6.4820856703822,8.72990105775358",
            "TWD,2022-12-18T00:43:51Z,90.4315941133921,105.197876491784,121.154479764599",
            "TW_,2022-12-18T00:44:51Z,5.82966020623345,7.69023163804152,9.85975942469941",
            "TWD,2022-12-18T00:44:51Z,89.937642322708,105.540693173145,125.139525843424",
            "TW_,2022-12-18T00:45:51Z,4.11941370399378,7.57671331625127,10.68872597472",
            "TWD,2022-12-18T00:45:51Z,87.190463535968,108.126052693655,131.591466962263",
            "TW_,2022-12-18T00:46:51Z,5.11002234836785,7.19895256590524,10.6296654598562",
            "TWD,2022-12-18T00:46:51Z,92.0737429813142,109.402224679688,127.605958337954",
            "TW_,2022-12-18T00:47:51Z,5.61873847744223,8.42193469074975,11.5495532626074",
            "TWD,2022-12-18T00:47:51Z,88.3355089026077,105.830196831837,126.262289793262",
    };


    private DBHelper helper;

    public void setUp() throws Exception {
        super.setUp();
        Injector injector = Guice.createInjector(new NMEARouterModule());
        ThingsFactory.setInjector(injector);
        MetricTestTableManager.setUp();
        MetricTestTableManager.loadTrackCSV(TEST_DATA);
        helper = new DBHelper(ConsoleLog.getLogger(), true);
        count = 0;
        ref = -1;
    }

    public void tearDown() throws Exception {
        MetricTestTableManager.tearDown();
        helper.close();
    }

    private int count = 0;
    private int ref = -1;
    @Test
    public void testLoadWindSpeed() throws DataManagementException {
        Instant d0 = Instant.parse("2022-12-11T10:26:17Z");
        Instant d1 = Instant.parse("2022-12-11T12:06:59Z");
        new DBMetricReader(ConsoleLog.getLogger()).readData(new QueryByDate(d0, d1), "TW_", (Sample sample) -> {
            count++;
            ref = getTestData("TW_", d0, d1, ref);
            assertNotSame(-1, ref);
            assertEquals(getTimestamp(ref).toEpochMilli(), sample.getTimestamp());
            assertEquals(getType(ref), sample.getTag());
            ref++;
        });
        assertEquals(26, count);
    }

    private static Instant getTimestamp(int i) {
        return Instant.parse(TEST_DATA[i].split(",")[1]);
    }

    private static String getType(int i) {
        return TEST_DATA[i].split(",")[0];
    }

    private int getTestData(String tag, Instant d0, Instant d1, int startFrom) {
        if (startFrom<0) startFrom = 0;
        for (int i = startFrom; i<TEST_DATA.length; i++) {
            Instant d = getTimestamp(i);
            if (TEST_DATA[i].startsWith(tag) && d.toEpochMilli()>=d0.toEpochMilli() && d.toEpochMilli()<=d1.toEpochMilli()) return i;
        }
        return -1;
    }
}